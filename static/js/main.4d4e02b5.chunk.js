(this["webpackJsonphive-social-network"]=this["webpackJsonphive-social-network"]||[]).push([[0],{68:function(e,t,n){},79:function(e,t,n){"use strict";n.r(t);n(68);var r=n(0),c=n.n(r),a=n(23),o=n.n(a),i=n(11),s=n(8),l=n(53),u=n(5),d=n(24),j=n(36),m=n.n(j),b=n(16),f=n(61),h=n(1),x=c.a.createContext({alerts:[],showAlert:function(e,t){return null},removeAlert:function(e){return null}});function p(e,t){switch(t.type){case"add":return[].concat(Object(f.a)(e),[{id:e.length+1,message:t.message,title:t.title}]);case"remove":return e.filter((function(e){return e.id!==t.id}));default:return e}}var O=function(e){var t=e.children,n=Object(r.useReducer)(p,[]),c=Object(b.a)(n,2),a=c[0],o=c[1],i=function(e){o({type:"remove",id:e})};return Object(r.useEffect)((function(){var e;return a.length&&(e=setTimeout((function(){i(a[0].id)}),5e3)),function(){e&&clearTimeout(e)}}),[a]),Object(h.jsx)(x.Provider,{value:{alerts:a,showAlert:function(e,t){o({type:"add",title:e,message:t})},removeAlert:i},children:t})},g=function(){return Object(r.useContext)(x)};function v(){var e=window.localStorage.getItem("color-mode");if("string"===typeof e)return e;var t=window.matchMedia("(prefers-color-scheme: dark)");return"boolean"===typeof t.matches&&t.matches?"dark":"light"}var y=c.a.createContext({colorMode:void 0,setColorMode:function(){return null}}),w=function(e){var t=e.children,n=Object(r.useState)(),c=Object(b.a)(n,2),a=c[0],o=c[1];Object(r.useEffect)((function(){o(v())}),[]);return Object(h.jsx)(y.Provider,{value:{colorMode:a,setColorMode:function(e){!function(e){document.documentElement.setAttribute("class",e)}(e),o(e),window.localStorage.setItem("color-mode",e)}},children:t})},k=n(6),N=n.n(k),C=n(17),_=n(54),E=n(55),S=n(56),A=new(function(){function e(){Object(E.a)(this,e)}return Object(S.a)(e,[{key:"post",value:function(){var e=Object(C.a)(N.a.mark((function e(t,n){var r,c;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.hive.blog",{method:"POST",body:JSON.stringify({id:1,jsonrpc:"2.0",params:n,method:t})});case 2:if((r=e.sent).ok){e.next=5;break}throw new Error("Post request failed: ".concat(r.statusText));case 5:return e.next=7,r.json();case 7:if(!(c=e.sent).error){e.next=10;break}throw new Error(c.error.message);case 10:return e.abrupt("return",c.result);case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}()),T=n(29),P=new T.Client(["https://api.hive.blog"]);function R(){return L.apply(this,arguments)}function L(){return(L=Object(C.a)(N.a.mark((function e(){var t;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.post("bridge.list_pop_communities",{limit:10});case 2:return t=e.sent,e.abrupt("return",t.map((function(e){var t=Object(b.a)(e,2);return{key:t[0],title:t[1]}})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(){return(I=Object(C.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",P.hivemind.getCommunity({name:t}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Q(){return(Q=Object(C.a)(N.a.mark((function e(t){var n;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.post("bridge.get_ranked_posts",{limit:10,sort:"trending",tag:t});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(){return(D=Object(C.a)(N.a.mark((function e(t){var n,r,c;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.permlink,r=t.author,e.next=3,A.post("bridge.get_post",{author:r,permlink:n});case 3:return c=e.sent,e.abrupt("return",c);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var U=Object({NODE_ENV:"production",PUBLIC_URL:"/hive-social-network-demo",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_HIVE_API_URL:"https://api.hive.blog",REACT_APP_HIVE_USER:"hiveiscool",REACT_APP_HIVE_POSTING:"5HrG2UCWNmGmbMgnyS6XZaqrZpn2rpV3gRZRKwukf1RNxCS4KFX"}),H=U.REACT_APP_HIVE_USER,M=U.REACT_APP_HIVE_POSTING;function K(e,t){return P.broadcast.json({id:"follow",required_posting_auths:[H],required_auths:[],json:JSON.stringify(["follow",{follower:e,following:t,what:[]}])},T.PrivateKey.from(M))}function V(){var e=Object(s.useQuery)("communities",R,{initialData:[]});return{communities:e.data,loading:e.isLoading,error:e.error}}function B(e){var t=Object(s.useQuery)(["communities",e],(function(){return function(e){return I.apply(this,arguments)}(e)}),{initialData:{}});return{community:t.data,loading:t.isLoading,error:t.error}}function W(e){var t=Object(s.useQueryClient)(),n=Object(s.useQuery)(["posts",e],(function(){return function(e){return Q.apply(this,arguments)}(e)}),{enabled:!!e,initialData:[],onSuccess:function(e){e.forEach((function(e){t.setQueryData(["posts",e.author,e.permlink],e)}))}});return{posts:n.data,loading:n.isLoading,error:n.error}}function q(e){var t=e.author,n=e.permlink,r=Object(s.useQuery)(["posts",t,n],(function(){return function(e){return D.apply(this,arguments)}({author:t,permlink:n})}),{initialData:{}});return{post:r.data,loading:r.isLoading,error:r.error}}function F(){var e=Object(r.useState)({}),t=Object(b.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(),o=Object(b.a)(a,2),i=o[0],s=o[1],l=Object(r.useState)(),u=Object(b.a)(l,2),d=u[0],j=u[1];return Object(r.useEffect)((function(){s(!0),P.database.getAccounts([H]).then((function(e){return c(e[0])})).catch(j).finally((function(){s(!1)}))}),[]),{account:n,loading:i,error:d}}function J(e){var t=Object(s.useQuery)("following-list",(function(){return function(e){return A.post("condenser_api.get_following",[e,null,"blog"])}(e)}),{initialData:[],enabled:!!e});return{following:t.data,loading:t.isLoading,error:t.error}}K(H,"tattoodjay");var G=n(30),Z=n(38),X=Object(r.forwardRef)((function(e,t){var n=e.active,r=e.children,c=e.onClick,a=Object(Z.a)(e,["active","children","onClick"]);return Object(h.jsx)("button",Object(G.a)(Object(G.a)({ref:t,className:m()("hover:bg-gray-800\n      hover:text-gray-200\n      dark:hover:bg-gray-200\n      dark:hover:text-gray-800\n      p-2\n      rounded-lg\n      font-semibold\n      text-lg",{"dark:bg-gray-100":n,"dark:text-gray-700":n,"bg-gray-700":n,"text-gray-100":n}),onClick:c},a),{},{children:r}))}));var Y=function(e){var t=e.label,n=e.items,c=void 0===n?[]:n,a=Object(r.useState)(!1),o=Object(b.a)(a,2),s=o[0],l=o[1],u=Object(r.useRef)(),d=Object(r.createRef)();return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];Object(r.useEffect)((function(){var r=function(r){!e.current||e.current.contains(r.target)||n.some((function(e){return e.current.contains(r.target)}))||t(r)};return document.addEventListener("mousedown",r),document.addEventListener("touchstart",r),function(){document.removeEventListener("mousedown",r),document.removeEventListener("touchstart",r)}}),[e,t,n])}(u,(function(){l(!1)}),[d]),Object(h.jsxs)("div",{className:"mx-2 relative",children:[Object(h.jsx)(X,{ref:d,active:s,onClick:function(){return l(!s)},children:t}),s&&Object(h.jsx)("ul",{ref:u,className:"absolute top-12 left-0 right-0 bg-gray-700 text-gray-100 dark:text-gray-800 dark:bg-white rounded-lg",children:c.map((function(e){var t=e.label,n=e.link;return Object(h.jsx)("li",{className:"p-2 font-semibold hover:opacity-75",onClick:function(){return l(!1)},children:Object(h.jsx)(i.b,{to:n,children:t})},t)}))})]})},z=function(){var e=Object(u.f)(),t=Object(r.useContext)(y),n=t.colorMode,c=t.setColorMode,a=g().showAlert,o=V(),s=o.communities,l=o.loading,j=o.error;return Object(r.useEffect)((function(){j&&a("Error when getting communities!",j.message)}),[j]),Object(h.jsxs)("nav",{className:"flex justify-between items-center my-8",children:[Object(h.jsxs)("div",{className:"flex",children:[Object(h.jsx)("span",{className:"text-3xl font-semibold mr-4 text-red-500 cursor-pointer",onClick:function(){return e.push("/")},children:"Hive Social Network"}),Object(h.jsx)(Y,{label:Object(h.jsxs)("span",{className:m()("flex items-center",{"opacity-60":l,"pointer-events-none":l,"cursor-wait":l}),children:["Trending Communities",l&&Object(h.jsx)(d.b,{className:"h-5 w-5 ml-2 animate-spin"})]}),items:s.map((function(e){var t=e.key;return{label:e.title,link:"/trending-communities/".concat(t)}}))}),Object(h.jsx)(X,{children:Object(h.jsx)(i.b,{to:"/profile",children:"Profile"})})]}),Object(h.jsxs)("button",{onClick:function(){"dark"===n?(c("light"),a("Theme changed","Just shine like a diamond \u2600\ufe0f")):(c("dark"),a("Theme changed","You can't escape from the darkness \ud83c\udf1a"))},children:["dark"===n&&Object(h.jsx)(d.c,{className:"h-10 w-10 text-yellow-300"}),"light"===n&&Object(h.jsx)(d.a,{className:"h-10 w-10 text-indigo-900"})]})]})},$=function(){var e=function(){var e=Object(s.useQueryClient)();return Object(r.useEffect)((function(){Object(C.a)(N.a.mark((function t(){var n,r,c,a,o,i,s;return N.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=!0,r=!1,t.prev=2,a=Object(_.a)(P.blockchain.getBlocks());case 4:return t.next=6,a.next();case 6:return o=t.sent,n=o.done,t.next=10,o.value;case 10:if(i=t.sent,n){t.next=17;break}s=i,e.setQueryData("block-info",{block_id:s.block_id,witness:s.witness,server_time:new Date(s.timestamp).toUTCString(),transactions:s.transaction_ids.length});case 14:n=!0,t.next=4;break;case 17:t.next=23;break;case 19:t.prev=19,t.t0=t.catch(2),r=!0,c=t.t0;case 23:if(t.prev=23,t.prev=24,n||null==a.return){t.next=28;break}return t.next=28,a.return();case 28:if(t.prev=28,!r){t.next=31;break}throw c;case 31:return t.finish(28);case 32:return t.finish(23);case 33:case"end":return t.stop()}}),t,null,[[2,19,23,33],[24,,28,32]])})))()}),[]),Object(s.useQuery)("block-info")}().data;return e?Object(h.jsxs)("div",{className:"flex flex-col",children:[Object(h.jsx)("h2",{className:"text-3xl mb-4",children:"Blockchain Info"}),Object.keys(e).map((function(t){return Object(h.jsxs)("label",{className:"flex flex-col mb-4 font-semibold text-gray-500",children:[t.toUpperCase(),Object(h.jsx)("span",{className:"font-normal text-gray-800 dark:text-white",children:e[t]})]},t)}))]}):Object(h.jsxs)("span",{className:"flex",children:["Subscribing to Blockchain Info"," ",Object(h.jsx)(d.b,{className:"h-5 w-5 ml-2 animate-spin"})]})},ee=function(){var e=V(),t=e.communities,n=e.loading;return Object(h.jsxs)("div",{className:"prose dark:text-white",children:[Object(h.jsx)("h2",{className:"dark:text-gray-50",children:"Welcome to Hive Social Network Platform!"}),Object(h.jsx)("h3",{className:"dark:text-gray-200",children:"Select a community to explore awesome contents \ud83e\udd73"}),n?Object(h.jsx)("div",{children:"Loading Top 10 Communities..."}):Object(h.jsx)("ul",{className:"flex flex-col",children:t.map((function(e){var t=e.key,n=e.title;return Object(h.jsx)(i.b,{className:"text-lg dark:text-gray-300",to:"/trending-communities/".concat(t),children:n},t)}))})]})},te=function(){var e=Object(u.g)().communityName,t=B(e),n=t.community,r=t.loading,c=t.error,a=W(e),o=a.posts,s=a.loading;if(r)return Object(h.jsx)("span",{children:"Loading community..."});if(c)return Object(h.jsxs)("span",{children:["An error occured when loading community: ",c.message]});var l=n.title,d=n.about,j=n.subscribers;return Object(h.jsxs)("div",{className:"w-full",children:[Object(h.jsxs)("h2",{className:"dark:text-gray-50 text-3xl",children:[l," ",Object(h.jsx)("small",{className:"font-light ml-2",children:Object(h.jsxs)("i",{children:[j," Subscribers"]})})]}),Object(h.jsx)("p",{className:"dark:text-gray-200 my-2",children:d}),Object(h.jsx)("div",{className:"flex flex-col",children:s?Object(h.jsxs)("span",{className:"text-green-400",children:["Loading community Posts for ",n.title,"..."]}):o.map((function(e){var t=e.post_id,n=e.title,r=e.permlink,c=e.author;return Object(h.jsxs)("div",{className:"flex justify-between p-4 my-2 bg-white w-full rounded-lg dark:text-gray-800",children:[n,Object(h.jsx)("button",{children:Object(h.jsx)(i.b,{to:"/trending-communities/posts/".concat(c,"/").concat(r),children:"Read"})})]},t)}))})]})},ne=function(){var e=g().showAlert,t=F(),n=t.account,r=t.loading,c=J(null===n||void 0===n?void 0:n.name),a=c.following,o=c.loading,i=Object(s.useQueryClient)(),l=Object(s.useMutation)(function(){var e=Object(C.a)(N.a.mark((function e(t){var n,r;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.myAccountName,r=t.accountToUnfollow,e.next=3,K(n,r);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{onSuccess:function(t,n){e("Unfollow successfull","Successfully unfollowed account ".concat(n.accountToUnfollow,", after 10 seconds list will be updated")),setTimeout((function(){i.invalidateQueries({queryKey:"following-list",exact:!0,refetchActive:!0,refetchInactive:!0}).then((function(){e("Refreshed follower list")}))}),1e4)},onError:function(t,n){e("Couldn't unfollow: ".concat(n.accountToUnfollow),t.message)}});if(r)return Object(h.jsx)("span",{className:"text-green-400",children:"Loading account info"});var u=n.name;return Object(h.jsxs)("div",{children:[Object(h.jsxs)("label",{className:"flex text-lg mb-4 font-semibold text-gray-500",children:["Account name:",Object(h.jsx)("span",{className:"font-normal text-gray-800 dark:text-white",children:u})]}),Object(h.jsx)("h3",{className:"text-2xl",children:"Followers "}),o?Object(h.jsx)("span",{className:"text-green-400",children:"Loading followers"}):Object(h.jsx)("ul",{className:"w-96",children:a.map((function(e){return Object(h.jsxs)("li",{className:"flex justify-between",children:[e.following,Object(h.jsx)("button",{onClick:function(){l.mutate({myAccountName:u,accountToUnfollow:e.following})},children:"Unfollow"})]},e.following)}))})]})},re=n(59),ce=n.n(re),ae=function(){var e=Object(u.g)(),t=q({author:e.author,permlink:e.permlink}),n=t.post,r=t.loading,c=Object(s.useQuery)("communities",{initialData:[],enabled:!!n,select:function(e){return e.filter((function(e){return e.key!==n.category}))}}),a=c.data,o=c.isIdle,l=n.body,d=n.title,j=n.author;return Object(h.jsxs)("div",{className:" py-2 rounded-lg grid grid-cols-3",children:[Object(h.jsxs)("ul",{className:"flex flex-col px-2",children:[Object(h.jsx)("h2",{className:"text-2xl text-center mb-6",children:"Check Other Communities"}),o?Object(h.jsx)("span",{children:" Waiting for communnity data... "}):a.map((function(e){var t=e.key,n=e.title;return Object(h.jsx)(X,{children:Object(h.jsx)(i.b,{to:"/trending-communities/".concat(t),children:n})},t)}))]}),r?Object(h.jsx)("span",{className:"text-green-400",children:"Loading..."}):Object(h.jsxs)("div",{className:"prose dark:bg-gray-50 col-span-2 p-4 rounded-lg max-w-full",children:[Object(h.jsxs)("h3",{children:["Author: ",j]}),Object(h.jsx)("h1",{children:d}),Object(h.jsx)("br",{}),Object(h.jsx)("article",{className:"prose mx-auto",dangerouslySetInnerHTML:{__html:ce()(l||"")}})]})]})},oe=function(){return Object(h.jsxs)(c.a.Fragment,{children:[Object(h.jsx)(z,{}),Object(h.jsxs)("section",{className:"grid grid-cols-4 gap-4",children:[Object(h.jsx)("main",{className:"col-span-3",children:Object(h.jsxs)(u.c,{children:[Object(h.jsx)(u.a,{path:"/",exact:!0,component:ee}),Object(h.jsx)(u.a,{path:"/trending-communities/:communityName",exact:!0,component:te}),Object(h.jsx)(u.a,{path:"/trending-communities/posts/:author/:permlink",exact:!0,component:ae}),Object(h.jsx)(u.a,{path:"/profile",exact:!0,component:ne})]})}),Object(h.jsx)($,{})]})]})},ie=n(60),se=function(e){var t=e.id,n=e.title,r=e.message,c=e.onClose;return Object(h.jsxs)("div",{className:"bg-gray-800\n      dark:bg-white\n      dark:text-gray-900\n      text-gray-50\n      flex\n      flex-col\n      p-4\n      w-80\n      rounded-lg\n      my-2 shadow-lg",children:[Object(h.jsxs)("div",{className:"flex justify-between mb-4",children:[Object(h.jsx)("h4",{className:"text-yellow-300 dark:text-yellow-600",children:n}),Object(h.jsx)("button",{onClick:function(){return c(t)},children:Object(h.jsx)(ie.a,{className:"h-6 w-6 text-white dark:text-gray-900"})})]}),r]})},le=function(){var e=g(),t=e.alerts,n=e.removeAlert;return o.a.createPortal(t.map((function(e){var t=e.id,r=Object(Z.a)(e,["id"]);return Object(h.jsx)(se,Object(G.a)({id:t,onClose:n},r),t)})),document.getElementById("alert-container"))};document.documentElement.setAttribute("class",v());var ue=new s.QueryClient({});o.a.render(Object(h.jsx)(c.a.StrictMode,{children:Object(h.jsx)(i.a,{children:Object(h.jsxs)(s.QueryClientProvider,{client:ue,children:[Object(h.jsx)(l.ReactQueryDevtools,{position:"bottom-right"}),Object(h.jsx)(O,{children:Object(h.jsxs)(w,{children:[Object(h.jsx)(le,{}),Object(h.jsx)(oe,{})]})})]})})}),document.getElementById("root"))}},[[79,1,2]]]);
//# sourceMappingURL=main.4d4e02b5.chunk.js.map